{"version":3,"file":"index.js","sources":["../src/index.ts"],"sourcesContent":["import * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport { compute, FidanValue } from \"@fidanjs/runtime\";\n\nexport const reactToDom = <T>(\n  Tag,\n  attributes: {\n    [key in keyof T]:\n      | FidanValue<typeof attributes[key]>\n      | typeof attributes[key]\n  },\n  ...childs: any[]\n) => {\n  const parent = document.createElement(\"template\");\n\n  const RenderWrapper = class extends React.Component {\n    state = {};\n    dynamics = [];\n    componentDidMount() {\n      const props = this.props;\n\n      compute(() => {\n        var newState = {};\n        for (var key in this.props) {\n          if (\n            typeof props[key] === \"function\" &&\n            props[key].hasOwnProperty(\"$val\")\n          ) {\n            newState[key] = props[key]();\n          }\n        }\n        this.setState(newState);\n      }, this.dynamics);\n    }\n    constructor(props) {\n      super(props);\n      for (var key in props) {\n        if (\n          typeof props[key] === \"function\" &&\n          props[key].hasOwnProperty(\"$val\")\n        ) {\n          this.dynamics.push(props[key]);\n          this.state[key] = props[key]();\n        } else this.state[key] = props[key];\n      }\n    }\n    render() {\n      return React.createElement(Tag, this.state, ...childs);\n    }\n  };\n  ReactDOM.render(React.createElement(RenderWrapper, attributes), parent);\n  return parent.firstElementChild;\n};\n\nexport const domToReact = (dom: DocumentFragment) => {\n  const integrationDomRef = (element: HTMLTemplateElement) => {\n    if (element) {\n      element.replaceWith(dom.cloneNode(true));\n    }\n  };\n\n  return React.createElement(\n    React.Fragment,\n    {},\n    React.createElement(\"template\", {\n      ref: integrationDomRef\n    })\n  );\n};\n"],"names":["reactToDom","Tag","attributes","parent","document","createElement","RenderWrapper","props","key","hasOwnProperty","dynamics","push","state","componentDidMount","compute","newState","this","setState","render","React","childs","ReactDOM","firstElementChild","domToReact","dom","integrationDomRef","element","replaceWith","cloneNode","ref"],"mappings":";;;;IAIaA,UAAU,aACrBC,GADwB,EAExBC,UAFwB;;;;MASlBC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,UAAvB,CAAf;MAEMC,aAAa;2BAmBLC;4BACJA,KAAN;gBAnBF,GAAQ,EAAR;mBACA,GAAW,EAAX;;WAmBO,IAAIC,GAAT,IAAgBD,KAAhB,EAAuB;YAEnB,OAAOA,KAAK,CAACC,GAAD,CAAZ,KAAsB,UAAtB,IACAD,KAAK,CAACC,GAAD,CAAL,CAAWC,cAAX,CAA0B,MAA1B,CAFF,EAGE;eACKC,QAAL,CAAcC,IAAd,CAAmBJ,KAAK,CAACC,GAAD,CAAxB;eACKI,KAAL,CAAWJ,GAAX,IAAkBD,KAAK,CAACC,GAAD,CAAL,EAAlB;SALF,QAMO,KAAKI,KAAL,CAAWJ,GAAX,IAAkBD,KAAK,CAACC,GAAD,CAAvB;;;;;;;;4BAzBXK;;;UACQN,KAAK,GAAG,KAAKA,KAAnB;MAEAO,eAAO;YACDC,QAAQ,GAAG,EAAf;;aACK,IAAIP,GAAT,IAAgBQ,OAAKT,KAArB,EAA4B;cAExB,OAAOA,KAAK,CAACC,GAAD,CAAZ,KAAsB,UAAtB,IACAD,KAAK,CAACC,GAAD,CAAL,CAAWC,cAAX,CAA0B,MAA1B,CAFF,EAGE;YACAM,QAAQ,CAACP,GAAD,CAAR,GAAgBD,KAAK,CAACC,GAAD,CAAL,EAAhB;;;;eAGCS,QAAL,CAAcF,QAAd;OAVK,EAWJ,KAAKL,QAXD,CAAP;;;4BAyBFQ;aACSC,yBAAA,UAAoBlB,GAApB,EAAyB,KAAKW,KAA9B,WAAwCQ,QAAxC,CAAP;;;;qBAhCJ;EAmCAC,eAAA,CAAgBF,mBAAA,CAAoBb,aAApB,EAAmCJ,UAAnC,CAAhB,EAAgEC,MAAhE;SACOA,MAAM,CAACmB,iBAAd;CA/CK;AAkDP,IAAaC,UAAU,aAAIC;MACnBC,iBAAiB,aAAIC;QACrBA,OAAJ,EAAa;MACXA,OAAO,CAACC,WAAR,CAAoBH,GAAG,CAACI,SAAJ,CAAc,IAAd,CAApB;;GAFJ;;SAMOT,mBAAA,CACLA,cADK,EAEL,EAFK,EAGLA,mBAAA,CAAoB,UAApB,EAAgC;IAC9BU,GAAG,EAAEJ;GADP,CAHK,CAAP;CAPK;;;;;"}